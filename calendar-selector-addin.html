<!-- calendar-selector-addin.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Kalenderauswahl</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    select, button { margin-top: 10px; width: 100%; padding: 8px; }
  </style>
</head>
<body>
  <h2>Termin speichern in...</h2>
  <label for="calendarSelect">Kalender auswählen:</label>
  <select id="calendarSelect">
    <option value="default">Standardkalender</option>
    <option value="/users/chef@firma.de/calendars/Messe">Messe</option>
    <option value="/users/chef@firma.de/calendars/GF">Geschäftsführung</option>
  </select>

  <button onclick="moveToCalendar()">In Kalender speichern</button>

  <p id="status"></p>

  <script>
    async function moveToCalendar() {
      const selected = document.getElementById("calendarSelect").value;
      const status = document.getElementById("status");

      try {
        await Office.onReady();
        const item = Office.context.mailbox.item;

        if (!item || !item.subject) {
          status.textContent = "Kein Termin gefunden.";
          return;
        }

        if (selected === "default") {
          status.textContent = "Termin bleibt im Standardkalender.";
          return;
        }

        // Hier könnte Microsoft Graph API verwendet werden, um Termin zu verschieben
        // Dies erfordert Azure App Registrierung und Token-Zugriff
        status.textContent = "Würde gespeichert in: " + selected + " (Demo-Modus)";
      } catch (e) {
        console.error(e);
        status.textContent = "Fehler beim Zugriff auf Termin.";
      }
    }
  </script>
</body>
</html>
